#define _POSIX_C_SOURCE 199309L
#include <time.h>
#include <stdio.h>

double bar() {
   
   return 1.0;
}

double bar2() {
   return 1.0;
}

double bar3() {
   return 1.0;
}

double foo() {
   double a = 0;
   for(int i = 0; i < 1000; i++) {
      struct timespec clava_timing_start_4, clava_timing_end_4;
      double clava_timing_duration_4;
      clock_gettime(CLOCK_MONOTONIC, &clava_timing_start_4);
      a += bar();
      clock_gettime(CLOCK_MONOTONIC, &clava_timing_end_4);
      clava_timing_duration_4 = ((clava_timing_end_4.tv_sec + ((double) clava_timing_end_4.tv_nsec / 1000000000)) - (clava_timing_start_4.tv_sec + ((double) clava_timing_start_4.tv_nsec / 1000000000))) * (1000);
      printf("Time:%fms\n", clava_timing_duration_4);
   }
   
   return a;
}


int main() {
   struct timespec clava_timing_start_5, clava_timing_end_5;
   double clava_timing_duration_5;
   clock_gettime(CLOCK_MONOTONIC, &clava_timing_start_5);
   foo();
   clock_gettime(CLOCK_MONOTONIC, &clava_timing_end_5);
   clava_timing_duration_5 = ((clava_timing_end_5.tv_sec + ((double) clava_timing_end_5.tv_nsec / 1000000000)) - (clava_timing_start_5.tv_sec + ((double) clava_timing_start_5.tv_nsec / 1000000000))) * (1000);
   printf("Time:%fms\n", clava_timing_duration_5);
   
   struct timespec clava_timing_start_6, clava_timing_end_6;
   double clava_timing_duration_6;
   clock_gettime(CLOCK_MONOTONIC, &clava_timing_start_6);
   bar2();
   clock_gettime(CLOCK_MONOTONIC, &clava_timing_end_6);
   clava_timing_duration_6 = ((clava_timing_end_6.tv_sec + ((double) clava_timing_end_6.tv_nsec / 1000000000)) - (clava_timing_start_6.tv_sec + ((double) clava_timing_start_6.tv_nsec / 1000000000))) * (1000);
   printf("I want to print the value of the elapsed time (%f), which is in the unit 'ms' and put other stuff after it\n", clava_timing_duration_6);

   struct timespec clava_timing_start_7, clava_timing_end_7;
   double clava_timing_duration_7;
   clock_gettime(CLOCK_MONOTONIC, &clava_timing_start_7);
   bar3();
   clock_gettime(CLOCK_MONOTONIC, &clava_timing_end_7);
   clava_timing_duration_7 = ((clava_timing_end_7.tv_sec + ((double) clava_timing_end_7.tv_nsec / 1000000000)) - (clava_timing_start_7.tv_sec + ((double) clava_timing_start_7.tv_nsec / 1000000000))) * (1000);
   printf("%fms\n", clava_timing_duration_7);
   printf("This should appear after the timer print\n");
}
